<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Xilinx Tools - Calyx Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Calyx Documentation</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
.mdbook-callouts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-radius: 4px;
  /* border-left: 0.25em solid var(--mdbook-callouts-color); */
  background: var(--mdbook-callouts-background);
}

.mdbook-callouts > *:first-child {
  margin-top: 0;
}

.mdbook-callouts > *:last-child {
  margin-bottom: 0;
}

.mdbook-callouts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-callouts-color);
  text-transform: capitalize;
}

.mdbook-callouts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-callouts-icon);
  mask-image: var(--mdbook-callouts-icon);
}

/* icons at: https://lucide.dev/icons/ */

.mdbook-callouts-info {
  --mdbook-callouts-color: rgb(var(--color-blue-rgb));
  --mdbook-callouts-background: rgba(var(--color-blue-rgb), 0.1);
  /* https://lucide.dev/icons/info */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWluZm8iPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIi8+PHBhdGggZD0iTTEyIDE2di00Ii8+PHBhdGggZD0iTTEyIDhoLjAxIi8+PC9zdmc+');
}

.mdbook-callouts-abstract,
.mdbook-callouts-summary,
.mdbook-callouts-tldr {
  --mdbook-callouts-color: rgb(var(--color-cyan-rgb));
  --mdbook-callouts-background: rgba(var(--color-cyan-rgb), 0.1);
  /* https://lucide.dev/icons/clipboard-list */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWNsaXBib2FyZC1saXN0Ij48cmVjdCB3aWR0aD0iOCIgaGVpZ2h0PSI0IiB4PSI4IiB5PSIyIiByeD0iMSIgcnk9IjEiLz48cGF0aCBkPSJNMTYgNGgyYTIgMiAwIDAgMSAyIDJ2MTRhMiAyIDAgMCAxLTIgMkg2YTIgMiAwIDAgMS0yLTJWNmEyIDIgMCAwIDEgMi0yaDIiLz48cGF0aCBkPSJNMTIgMTFoNCIvPjxwYXRoIGQ9Ik0xMiAxNmg0Ii8+PHBhdGggZD0iTTggMTFoLjAxIi8+PHBhdGggZD0iTTggMTZoLjAxIi8+PC9zdmc+');
}

.mdbook-callouts-todo {
  --mdbook-callouts-color: rgb(var(--color-blue-rgb));
  --mdbook-callouts-background: rgba(var(--color-blue-rgb), 0.1);
  /* https://lucide.dev/icons/check-circle-2 */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWNoZWNrLWNpcmNsZS0yIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIvPjxwYXRoIGQ9Im05IDEyIDIgMiA0LTQiLz48L3N2Zz4=');
}

.mdbook-callouts-note {
  --mdbook-callouts-color: rgb(var(--color-blue-rgb));
  --mdbook-callouts-background: rgba(var(--color-blue-rgb), 0.1);
  /* https://lucide.dev/icons/pencil */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXBlbmNpbCI+PHBhdGggZD0iTTE3IDNhMi44NSAyLjgzIDAgMSAxIDQgNEw3LjUgMjAuNSAyIDIybDEuNS01LjVaIi8+PHBhdGggZD0ibTE1IDUgNCA0Ii8+PC9zdmc+');
}

.mdbook-callouts-tip,
.mdbook-callouts-hint {
  --mdbook-callouts-color: rgb(var(--color-cyan-rgb));
  --mdbook-callouts-background: rgba(var(--color-cyan-rgb), 0.1);
  /* https://lucide.dev/icons/flame */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWZsYW1lIj48cGF0aCBkPSJNOC41IDE0LjVBMi41IDIuNSAwIDAgMCAxMSAxMmMwLTEuMzgtLjUtMi0xLTMtMS4wNzItMi4xNDMtLjIyNC00LjA1NCAyLTYgLjUgMi41IDIgNC45IDQgNi41IDIgMS42IDMgMy41IDMgNS41YTcgNyAwIDEgMS0xNCAwYzAtMS4xNTMuNDMzLTIuMjk0IDEtM2EyLjUgMi41IDAgMCAwIDIuNSAyLjV6Ii8+PC9zdmc+');
}

.mdbook-callouts-important {
  --mdbook-callouts-color: rgb(var(--color-purple-rgb));
  --mdbook-callouts-background: rgba(var(--color-purple-rgb), 0.1);
  /* https://lucide.dev/icons/alert-circle */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWFsZXJ0LWNpcmNsZSI+PGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiLz48bGluZSB4MT0iMTIiIHgyPSIxMiIgeTE9IjgiIHkyPSIxMiIvPjxsaW5lIHgxPSIxMiIgeDI9IjEyLjAxIiB5MT0iMTYiIHkyPSIxNiIvPjwvc3ZnPg==');
}

.mdbook-callouts-success,
.mdbook-callouts-check,
.mdbook-callouts-done {
  --mdbook-callouts-color: rgb(var(--color-green-rgb));
  --mdbook-callouts-background: rgba(var(--color-green-rgb), 0.1);
  /* https://lucide.dev/icons/check */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWNoZWNrIj48cGF0aCBkPSJNMjAgNiA5IDE3bC01LTUiLz48L3N2Zz4=');
}

.mdbook-callouts-question,
.mdbook-callouts-help,
.mdbook-callouts-faq {
  --mdbook-callouts-color: rgb(var(--color-pink-rgb));
  --mdbook-callouts-background: rgba(var(--color-pink-rgb), 0.1);
  /* https://lucide.dev/icons/help-circle */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWhlbHAtY2lyY2xlIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIvPjxwYXRoIGQ9Ik05LjA5IDlhMyAzIDAgMCAxIDUuODMgMWMwIDItMyAzLTMgMyIvPjxwYXRoIGQ9Ik0xMiAxN2guMDEiLz48L3N2Zz4=');
}

.mdbook-callouts-coding {
  --mdbook-callouts-color: rgb(var(--color-green-rgb));
  --mdbook-callouts-background: rgba(var(--color-green-rgb), 0.1);
  /* https://lucide.dev/icons/help-circle */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWNvZGUiPjxwb2x5bGluZSBwb2ludHM9IjE2IDE4IDIyIDEyIDE2IDYiLz48cG9seWxpbmUgcG9pbnRzPSI4IDYgMiAxMiA4IDE4Ii8+PC9zdmc+');
}

.mdbook-callouts-challenge {
  --mdbook-callouts-color: rgb(var(--color-red-rgb));
  --mdbook-callouts-background: rgba(var(--color-red-rgb), 0.1);
  /* https://lucide.dev/icons/help-circle */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXN3b3JkcyI+PHBvbHlsaW5lIHBvaW50cz0iMTQuNSAxNy41IDMgNiAzIDMgNiAzIDE3LjUgMTQuNSIvPjxsaW5lIHgxPSIxMyIgeDI9IjE5IiB5MT0iMTkiIHkyPSIxMyIvPjxsaW5lIHgxPSIxNiIgeDI9IjIwIiB5MT0iMTYiIHkyPSIyMCIvPjxsaW5lIHgxPSIxOSIgeDI9IjIxIiB5MT0iMjEiIHkyPSIxOSIvPjxwb2x5bGluZSBwb2ludHM9IjE0LjUgNi41IDE4IDMgMjEgMyAyMSA2IDE3LjUgOS41Ii8+PGxpbmUgeDE9IjUiIHgyPSI5IiB5MT0iMTQiIHkyPSIxOCIvPjxsaW5lIHgxPSI3IiB4Mj0iNCIgeTE9IjE3IiB5Mj0iMjAiLz48bGluZSB4MT0iMyIgeDI9IjUiIHkxPSIxOSIgeTI9IjIxIi8+PC9zdmc+');
}

.mdbook-callouts-warning,
.mdbook-callouts-warn,
.mdbook-callouts-attention {
  --mdbook-callouts-color: rgb(var(--color-orange-rgb));
  --mdbook-callouts-background: rgba(var(--color-orange-rgb), 0.1);
  /* https://lucide.dev/icons/alert-triangle */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWFsZXJ0LXRyaWFuZ2xlIj48cGF0aCBkPSJtMjEuNzMgMTgtOC0xNGEyIDIgMCAwIDAtMy40OCAwbC04IDE0QTIgMiAwIDAgMCA0IDIxaDE2YTIgMiAwIDAgMCAxLjczLTNaIi8+PHBhdGggZD0iTTEyIDl2NCIvPjxwYXRoIGQ9Ik0xMiAxN2guMDEiLz48L3N2Zz4=');
}

.mdbook-callouts-caution {
  --mdbook-callouts-color: rgb(var(--color-red-rgb));
  --mdbook-callouts-background: rgba(var(--color-red-rgb), 0.1);
  /* https://lucide.dev/icons/shield-alert */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXNoaWVsZC1hbGVydCI+PHBhdGggZD0iTTEyIDIyczgtNCA4LTEwVjVsLTgtMy04IDN2N2MwIDYgOCAxMCA4IDEwIi8+PHBhdGggZD0iTTEyIDh2NCIvPjxwYXRoIGQ9Ik0xMiAxNmguMDEiLz48L3N2Zz4=');
}

.mdbook-callouts-failure,
.mdbook-callouts-fail,
.mdbook-callouts-missing {
  --mdbook-callouts-color: rgb(var(--color-red-rgb));
  --mdbook-callouts-background: rgba(var(--color-red-rgb), 0.1);
  /* https://lucide.dev/icons/x */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXgiPjxwYXRoIGQ9Ik0xOCA2IDYgMTgiLz48cGF0aCBkPSJtNiA2IDEyIDEyIi8+PC9zdmc+');
}

.mdbook-callouts-error,
.mdbook-callouts-danger {
  --mdbook-callouts-color: rgb(var(--color-red-rgb));
  --mdbook-callouts-background: rgba(var(--color-red-rgb), 0.1);
  /* https://lucide.dev/icons/zap */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXphcCI+PHBvbHlnb24gcG9pbnRzPSIxMyAyIDMgMTQgMTIgMTQgMTEgMjIgMjEgMTAgMTIgMTAgMTMgMiIvPjwvc3ZnPg==');
}

.mdbook-callouts-bug {
  --mdbook-callouts-color: rgb(var(--color-red-rgb));
  --mdbook-callouts-background: rgba(var(--color-red-rgb), 0.1);
  /* https://lucide.dev/icons/bug */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWJ1ZyI+PHBhdGggZD0ibTggMiAxLjg4IDEuODgiLz48cGF0aCBkPSJNMTQuMTIgMy44OCAxNiAyIi8+PHBhdGggZD0iTTkgNy4xM3YtMWEzLjAwMyAzLjAwMyAwIDEgMSA2IDB2MSIvPjxwYXRoIGQ9Ik0xMiAyMGMtMy4zIDAtNi0yLjctNi02di0zYTQgNCAwIDAgMSA0LTRoNGE0IDQgMCAwIDEgNCA0djNjMCAzLjMtMi43IDYtNiA2Ii8+PHBhdGggZD0iTTEyIDIwdi05Ii8+PHBhdGggZD0iTTYuNTMgOUM0LjYgOC44IDMgNy4xIDMgNSIvPjxwYXRoIGQ9Ik02IDEzSDIiLz48cGF0aCBkPSJNMyAyMWMwLTIuMSAxLjctMy45IDMuOC00Ii8+PHBhdGggZD0iTTIwLjk3IDVjMCAyLjEtMS42IDMuOC0zLjUgNCIvPjxwYXRoIGQ9Ik0yMiAxM2gtNCIvPjxwYXRoIGQ9Ik0xNy4yIDE3YzIuMS4xIDMuOCAxLjkgMy44IDQiLz48L3N2Zz4=');
}

.mdbook-callouts-examples,
.mdbook-callouts-example {
  --mdbook-callouts-color: rgb(var(--color-purple-rgb));
  --mdbook-callouts-background: rgba(var(--color-purple-rgb), 0.1);
  /* https://lucide.dev/icons/list */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLWxpc3QiPjxsaW5lIHgxPSI4IiB4Mj0iMjEiIHkxPSI2IiB5Mj0iNiIvPjxsaW5lIHgxPSI4IiB4Mj0iMjEiIHkxPSIxMiIgeTI9IjEyIi8+PGxpbmUgeDE9IjgiIHgyPSIyMSIgeTE9IjE4IiB5Mj0iMTgiLz48bGluZSB4MT0iMyIgeDI9IjMuMDEiIHkxPSI2IiB5Mj0iNiIvPjxsaW5lIHgxPSIzIiB4Mj0iMy4wMSIgeTE9IjEyIiB5Mj0iMTIiLz48bGluZSB4MT0iMyIgeDI9IjMuMDEiIHkxPSIxOCIgeTI9IjE4Ii8+PC9zdmc+');
}

.mdbook-callouts-quote {
  --mdbook-callouts-color: rgb(158, 158, 158);
  --mdbook-callouts-background: rgba(158, 158, 158, 0.1);
  /* https://lucide.dev/icons/quote */
  --mdbook-callouts-icon: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJsdWNpZGUgbHVjaWRlLXF1b3RlIj48cGF0aCBkPSJNMyAyMWMzIDAgNy0xIDctOFY1YzAtMS4yNS0uNzU2LTIuMDE3LTItMkg0Yy0xLjI1IDAtMiAuNzUtMiAxLjk3MlYxMWMwIDEuMjUuNzUgMiAyIDIgMSAwIDEgMCAxIDF2MWMwIDEtMSAyLTIgMnMtMSAuMDA4LTEgMS4wMzFWMjBjMCAxIDAgMSAxIDF6Ii8+PHBhdGggZD0iTTE1IDIxYzMgMCA3LTEgNy04VjVjMC0xLjI1LS43NTctMi4wMTctMi0yaC00Yy0xLjI1IDAtMiAuNzUtMiAxLjk3MlYxMWMwIDEuMjUuNzUgMiAyIDJoLjc1YzAgMi4yNS4yNSA0LTIuNzUgNHYzYzAgMSAwIDEgMSAxeiIvPjwvc3ZnPg==');
}


.ayu {
  --color-red-rgb: 251, 70, 76;
  --color-red: #fb464c;
  --color-orange-rgb: 233, 151, 63;
  --color-orange: #e9973f;
  --color-yellow-rgb: 224, 222, 113;
  --color-yellow: #e0de71;
  --color-green-rgb: 68, 207, 110;
  --color-green: #44cf6e;
  --color-cyan-rgb: 83, 223, 221;
  --color-cyan: #53dfdd;
  --color-blue-rgb: 2, 122, 255;
  --color-blue: #027aff;
  --color-purple-rgb: 168, 130, 255;
  --color-purple: #a882ff;
  --color-pink-rgb: 250, 153, 205;
  --color-pink: #fa99cd;
}

.light {
  --color-red-rgb: 233, 49, 71;
  --color-red: #e93147;
  --color-orange-rgb: 236, 117, 0;
  --color-orange: #ec7500;
  --color-yellow-rgb: 224, 172, 0;
  --color-yellow: #e0ac00;
  --color-green-rgb: 8, 185, 78;
  --color-green: #08b94e;
  --color-cyan-rgb: 0, 191, 188;
  --color-cyan: #00bfbc;
  --color-blue-rgb: 8, 109, 221;
  --color-blue: #086ddd;
  --color-purple-rgb: 120, 82, 238;
  --color-purple: #7852ee;
  --color-pink-rgb: 213, 57, 132;
  --color-pink: #d53984;
}

.coal {
  --color-red-rgb: 251, 70, 76;
  --color-red: #fb464c;
  --color-orange-rgb: 233, 151, 63;
  --color-orange: #e9973f;
  --color-yellow-rgb: 224, 222, 113;
  --color-yellow: #e0de71;
  --color-green-rgb: 68, 207, 110;
  --color-green: #44cf6e;
  --color-cyan-rgb: 83, 223, 221;
  --color-cyan: #53dfdd;
  --color-blue-rgb: 2, 122, 255;
  --color-blue: #027aff;
  --color-purple-rgb: 168, 130, 255;
  --color-purple: #a882ff;
  --color-pink-rgb: 250, 153, 205;
  --color-pink: #fa99cd;
}

.navy {
  --color-red-rgb: 251, 70, 76;
  --color-red: #fb464c;
  --color-orange-rgb: 233, 151, 63;
  --color-orange: #e9973f;
  --color-yellow-rgb: 224, 222, 113;
  --color-yellow: #e0de71;
  --color-green-rgb: 68, 207, 110;
  --color-green: #44cf6e;
  --color-cyan-rgb: 83, 223, 221;
  --color-cyan: #53dfdd;
  --color-blue-rgb: 2, 122, 255;
  --color-blue: #027aff;
  --color-purple-rgb: 168, 130, 255;
  --color-purple: #a882ff;
  --color-pink-rgb: 250, 153, 205;
  --color-pink: #fa99cd;
}

.rust {
  --color-red-rgb: 233, 49, 71;
  --color-red: #e93147;
  --color-orange-rgb: 236, 117, 0;
  --color-orange: #ec7500;
  --color-yellow-rgb: 224, 172, 0;
  --color-yellow: #e0ac00;
  --color-green-rgb: 8, 185, 78;
  --color-green: #08b94e;
  --color-cyan-rgb: 0, 191, 188;
  --color-cyan: #00bfbc;
  --color-blue-rgb: 8, 109, 221;
  --color-blue: #086ddd;
  --color-purple-rgb: 120, 82, 238;
  --color-purple: #7852ee;
  --color-pink-rgb: 213, 57, 132;
  --color-pink: #d53984;
}

</style>
<h1 id="xilinx-toolchain"><a class="header" href="#xilinx-toolchain">Xilinx Toolchain</a></h1>
<blockquote>
<p>Working with vendor EDA toolchains is never a fun experience. Something will
almost certainly go wrong. If you're at Cornell, you can at least avoid
installing the tools yourself by using our lab servers, <a href="https://capra.cs.cornell.edu/private/gorgonzola.html">Gorgonzola</a> or <a href="https://capra.cs.cornell.edu/private/havarti.html">Havarti</a>.</p>
</blockquote>
<p><code>fud</code> can interact with the Xilinx tools (<a href="https://www.xilinx.com/products/design-tools/vivado.html">Vivado</a>, <a href="https://www.xilinx.com/products/design-tools/vivado/integration/esl-design.html">Vivado HLS</a>, and <a href="https://www.xilinx.com/products/design-tools/vitis/vitis-platform.html">Vitis</a>). There are three main things it can do:</p>
<ul>
<li>Synthesize Calyx-generated RTL designs to collect area and resource estimates.</li>
<li>Compile <a href="https://capra.cs.cornell.edu/dahlia/">Dahlia</a> programs via C++ and <a href="https://www.xilinx.com/products/design-tools/vivado/integration/esl-design.html">Vivado HLS</a> for comparison with the Calyx backend.</li>
<li>Compile Calyx programs for <em>actual execution</em> in Xilinx emulation modes or on real FPGA hardware.</li>
</ul>
<p>You can set <code>fud</code> up to use either a local installation of the Xilinx tools or one on a remote server, via SSH.</p>
<h2 id="synthesis-only"><a class="header" href="#synthesis-only">Synthesis Only</a></h2>
<p>The simplest way to use the Xilinx tools is to synthesize RTL or HLS designs to collect statistics about them.
This route will not produce actual, runnable executables; see the next section for that.</p>
<h3 id="setting-up-remote-tools"><a class="header" href="#setting-up-remote-tools">Setting up Remote Tools</a></h3>
<blockquote>
<p>Follow these instructions if you're attempting to run <code>vivado</code> or <code>vivado-hls</code> on a server from your local machine. If you are working directly on a server with these tools, skip to the <a href="#run">run instructions</a>.</p>
</blockquote>
<p>To set up to <strong>invoke the Xilinx tools over SSH</strong>, first tell <code>fud</code> your username and hostname for the server:</p>
<pre><code># Vivado
fud config stages.synth-verilog.ssh_host &lt;hostname&gt;
fud config stages.synth-verilog.ssh_username &lt;username&gt;

# Vivado HLS
fud config stages.vivado-hls.ssh_host &lt;hostname&gt;
fud config stages.vivado-hls.ssh_username &lt;username&gt;
</code></pre>
<p>The following commands enable remote usage of <code>vivado</code> and <code>vivado-hls</code> by default:</p>
<pre><code>fud config stages.synth-verilog.remote 1
fud config stages.vivado-hls.remote 1
</code></pre>
<p>The server must have <code>vivado</code> and <code>vivado_hls</code> available on the remote machine's path. (If you need the executable names to be something else, please file an issue.)</p>
<p>To tell if this has been set up correctly, run <code>ssh &lt;username&gt;@&lt;xilinx.tool.server&gt;</code> and ensure that you are not prompted for a password. The <code>ssh-copy-id</code> command will let you setup your server to authenticate without a password. Note that after you SSH into the server, the Vivado command should work without needing to run any source command.</p>
<p>Here's how you would ssh into Havarti:</p>
<pre><code>ssh user@havarti.cs.cornell.edu
user@havarti:~$ vivado

****** Vivado v2020.2 (64-bit)
</code></pre>
<h3 id="setting-up-local-tools"><a class="header" href="#setting-up-local-tools">Setting up Local Tools</a></h3>
<p>To instead <strong>invoke the Xilinx tools locally</strong>, just let <code>fud</code> run the <code>vivado</code> and <code>vivado_hls</code> commands.
You can optionally tell <code>fud</code> where these commands exist on your machine:</p>
<pre><code>fud config stages.synth-verilog.exec &lt;path&gt; # update vivado path
fud config stages.vivado-hls.exec &lt;path&gt; # update vivado_hls path
</code></pre>
<p>Setting the <code>remote</code> option for the stages to <code>0</code> ensure that <code>fud</code> will always try to run the commands locally.</p>
<pre><code>fud config stages.synth-verilog.remote 0
fud config stages.vivado-hls.remote 0
</code></pre>
<h3 id="run"><a class="header" href="#run">Run</a></h3>
<p>To run the entire toolchain and extract statistics from RTL synthesis, use the <code>resource-estimate</code> target state.
For example:</p>
<pre><code>fud e --to resource-estimate examples/futil/dot-product.futil
</code></pre>
<p>To instead obtain the raw synthesis results, use <code>synth-files</code>.</p>
<p>To run the analogous toolchain for Dahlia programs via HLS, use the <code>hls-estimate</code> target state:</p>
<pre><code>fud e --to hls-estimate examples/dahlia/dot-product.fuse
</code></pre>
<p>There is also an <code>hls-files</code> state for the raw results of Vivado HLS.</p>
<h2 id="emulation-and-execution"><a class="header" href="#emulation-and-execution">Emulation and Execution</a></h2>
<p><code>fud</code> can also compile Calyx programs for actual execution, either in the Xilinx toolchain's emulation modes or for running on a physical FPGA.
This route involves generating an <a href="https://en.wikipedia.org/wiki/Advanced_eXtensible_Interface">AXI</a> interface wrapper for the Calyx program and invoking it using Xilinx's <a href="https://github.com/Xilinx/PYNQ">PYNQ</a> interface.</p>
<h3 id="set-up"><a class="header" href="#set-up">Set Up</a></h3>
<p>As above, you can invoke the Xilinx toolchain locally or remotely, via SSH.
To set up SSH execution, you can edit your <code>config.toml</code> to add settings like this:</p>
<pre><code>[stages.xclbin]
ssh_host = "havarti"
ssh_username = "als485"
remote = 1
</code></pre>
<p>To use local execution, just leave off the <code>remote = true</code> line.</p>
<p>You can also set the Xilinx mode and target device:</p>
<pre><code>[stages.xclbin]
mode = "hw_emu"
device = "xilinx_u50_gen3x16_xdma_201920_3"
</code></pre>
<p>The options for <code>mode</code> are <code>hw_emu</code> (simulation) and <code>hw</code> (on-FPGA execution).
The device string above is for the <a href="https://www.xilinx.com/products/boards-and-kits/alveo/u50.html">Alveo U50</a> card, which we have at Cornell. The installed Xilinx card would typically be found under the directory <code>/opt/xilinx/platforms</code>, where one would be able to find a device name of interest.</p>
<p>To run simulations (or on real FPGAs), you will also need to configure the <code>fpga</code> stage to point to your installations of <a href="https://www.xilinx.com/products/design-tools/vitis/vitis-platform.html">Vitis</a> and <a href="https://xilinx.github.io/XRT/">XRT</a>:</p>
<pre><code>[stages.fpga]
xilinx_location = "/scratch/opt/Xilinx/Vitis/2020.2"
xrt_location = "/scratch/opt/xilinx/xrt"
</code></pre>
<p>Those are the paths on Cornell's havarti server.</p>
<h3 id="compile"><a class="header" href="#compile">Compile</a></h3>
<p>The first step in the Xilinx toolchain is to generate <a href="https://xilinx.github.io/XRT/2021.2/html/formats.html#xclbin">an <code>xclbin</code> executable file</a>.
Here's an example of going all the way from a Calyx program to that:</p>
<pre><code>fud e examples/futil/dot-product.futil -o foo.xclbin --to xclbin
</code></pre>
<p>On our machines, compiling even a simple example like the above for simulation takes about 5 minutes, end to end.
A failed run takes about 2 minutes to produce an error.</p>
<p>By default, the Xilinx tools run in a temporary directory that is deleted when <code>fud</code> finishes.
To instead keep the sandbox directory, use <code>-s xclbin.save_temps true</code>.
You can then find the results in a directory named <code>fud-out-N</code> for some number <code>N</code>.</p>
<h3 id="execute"><a class="header" href="#execute">Execute</a></h3>
<p>Now that you have an <code>xclbin</code>, the next step is to run it.
Here's a fud invocation that goes from the <code>xclbin</code> stage to the <code>fpga</code> stage:</p>
<pre><code>fud e foo.xclbin --from xclbin --to fpga -s fpga.data examples/dahlia/dot-product.fuse.data
</code></pre>
<p>fud will print out JSON memory contents in the same format as for other RTL simulators.</p>
<h4 id="waveform-debugging"><a class="header" href="#waveform-debugging">Waveform Debugging</a></h4>
<p>In emulation mode, this stage can produce a waveform trace in Xilinx's proprietary <a href="https://support.xilinx.com/s/article/64000?language=en_US">WDB</a> file format as well as a standard <a href="https://en.wikipedia.org/wiki/Value_change_dump">VCD</a> file.</p>
<p>Use the fud options <code>-s fpga.waveform true -s fpga.save_temps true</code> when emulating your program.
The first option instructs XRT to use <a href="https://xilinx.github.io/Vitis_Accel_Examples/2021.1/html/debug_profile.html">the <code>batch</code> debug mode</a> and to dump a VCD, and the second asks fud not to delete the directory where the waveform files will appear.</p>
<p>Then, look in the resulting directory, which will be named <code>fud-out-*</code> for some <code>*</code>.
In there, the Xilinx trace files you want are named <code>*.wdb</code> and <code>*.wcfg</code>.
The VCD file is at <code>.run/*/hw_em/device0/binary_0/behav_waveform/xsim/dump.vcd</code> or similar.</p>
<h3 id="wip-calyx-native--fud2-xilinx-workflows"><a class="header" href="#wip-calyx-native--fud2-xilinx-workflows">WIP: Calyx-native &amp; fud2 Xilinx Workflows</a></h3>
<div class="warning">
<p>The two pieces described in this section (the <a href="../fud2">fud2</a> workflow and the Calyx-implemented AXI controllers) are a work in progress.
Use at your own risk and expect some hiccups!</p>
</div>
<p>The workflows described elsewhere on this page rely on an AXI interfaces that are implemented as a Verilog code generator, as part of the Calyx compiler.
Work is ongoing to instead implement AXI interfaces entirely in Calyx.
This work also includes <a href="../fud2">fud2</a> support.
This section describes this work-in-progress alternative route.</p>
<p>To take a Calyx file to something that can be emulated/executed with Xilinx via fud2,
there are a few commands that need to be run. The following assumes the
existence of a <code>dyn-vec-add.futil</code> file. The <code>dyn</code> prefix suggests that the Calyx memories
used are <a href="https://github.com/calyxir/calyx/blob/main/primitives/memories/dyn.sv">dynamic memories</a>, such as <code>dyn_mem_d1</code>.</p>
<p>You will need to build the YXI interface analysis tool, which you can do with <code>cargo build -p yxi</code>.</p>
<ol>
<li>
<p>Create a <code>.yxi</code> file, which describes the memory interface of the vector adder:</p>
<pre><code class="language-bash">fud2 dyn-vec-add.futil -o dyn-vec-add.yxi
</code></pre>
</li>
<li>
<p>Wrap the Calyx file with AXI memory controllers (implemented in Calyx):</p>
<pre><code class="language-bash">fud2 dyn-vec-add.futil --from calyx --to calyx --through axi-wrapped --set dynamic=true --set xilinx.controlled=true -o axi-wrapped.futil
</code></pre>
<p>If your original Calyx file uses <code>std_mem_*</code> memories, you'll want to leave out the <code>--set dynamic=true</code>.
Setting <code>xilinx.controlled=true</code> is required to run through Xilinx. Setting this generates a subordinate AXI controller for managing the accelerator's execution according
to Vitis <a href="https://docs.amd.com/r/en-US/ug1701-vitis-accelerated-embedded/RTL-Kernel-Interface-Requirements">requirements</a>.
AXI-wrapped Calyx that does <em>not</em> have this Xilinx-specific management controller can be tested via <a href="../interfacing.html#cocotb">Cocotb</a>.</p>
</li>
<li>
<p>Translate the wrapped Calyx file into Verilog. At this point, you need to decide if you
are targeting emulation or execution. If you are targeting execution make sure the target is <code>verilog-noverify</code>, as opposed to (the default) <code>verilog</code>:</p>
<pre><code class="language-bash">fud2 axi-wrapped.futil --set calyx.args=--synthesis --to verilog-noverify -o axi-wrapped.v
</code></pre>
</li>
<li>
<p>Generate a <code>.xo</code> from the verilog created, and the <code>.yxi</code> file created in step 1.
Based on what was targeted in the last step, either <code>xilinx.mode=hw_emu</code> (the default)
or set <code>xilinx.mode=hw</code>.</p>
<pre><code class="language-bash">fud2 axi-wrapped.v -o axi-wrapped.xo --set yxi.file=dyn-vec-add.yxi --set xilinx.mode=hw_emu
</code></pre>
</li>
<li>
<p>Generate a <code>.xclbin</code>. Use the same <code>xilinx.mode</code> setting from the previous step:</p>
<pre><code class="language-bash">fud2 axi-wrapped.xo -o axi-wrapped.xclbin --set xilinx.mode=hw_emu
</code></pre>
</li>
</ol>
<p>Now that we have a <code>.xclbin</code> file, we can execute our design with our <a href="#execution-via-xclrun">xclrun tool</a>.</p>
<h3 id="how-it-works"><a class="header" href="#how-it-works">How it Works</a></h3>
<p>The first step is to generate input files.
We need to generate:</p>
<ul>
<li>The RTL for the design itself, using the compile command-line flags <code>-b verilog --synthesis -p external</code>. We name this file <code>main.sv</code>.</li>
<li>A Verilog interface wrapper, using <code>XilinxInterfaceBackend</code>, via <code>-b xilinx</code>. We call this <code>toplevel.v</code>.</li>
<li>An XML document describing the interface, using <code>XilinxXmlBackend</code>, via <code>-b xilinx-xml</code>. This file gets named <code>kernel.xml</code>.</li>
</ul>
<p>The <code>fud</code> driver gathers these files together in a sandbox directory.
The next step is to run the Xilinx tools.</p>
<p>The rest of this section describes how this workflow works under the hood.
If you want to follow along by typing commands manually, you can start by invoking the setup scripts for <a href="https://www.xilinx.com/products/design-tools/vitis/vitis-platform.html">Vitis</a> and <a href="https://xilinx.github.io/XRT/">XRT</a>:</p>
<pre><code>source &lt;Vitis_install_path&gt;/Vitis/2020.1/settings64.sh
source /opt/xilinx/xrt/setup.sh
</code></pre>
<p>On some Ubuntu setups, you may need to update <code>LIBRARY_PATH</code>:</p>
<pre><code>export LIBRARY_PATH=/usr/lib/x86_64-linux-gnu
</code></pre>
<p>You can check that everything is working by typing <code>vitis -version</code> or <code>vivado -version</code>.</p>
<h4 id="background-xo-and-xclbin"><a class="header" href="#background-xo-and-xclbin">Background: <code>.xo</code> and <code>.xclbin</code></a></h4>
<p>In the Xilinx toolchain, compilation to an executable bitstream (or simulation blob) appears to requires two steps:
taking your Verilog sources and creating an <code>.xo</code> file, and then taking that and producing an <code>.xclbin</code> “executable” file.
The idea appears to be a kind of metaphor for a standard C compilation workflow in software-land: <code>.xo</code> is like a <code>.o</code> object file, and <code>.xclbin</code> contains actual executable code (bitstream or emulation equivalent), like a software executable binary.
Going from Verilog to <code>.xo</code> is like “compilation” and going from <code>.xo</code> to <code>.xclbin</code> is like “linking.”</p>
<p>However,  this analogy is kind of a lie.
Generating an <code>.xo</code> file actually does very little work:
it just packages up the Verilog source code and some auxiliary files.
An <code>.xo</code> is literally a zip file with that stuff packed up inside.
All the actual work happens during “linking,” i.e., going from <code>.xo</code> to <code>.xclbin</code> using the <code>v++</code> tool.
This situation is a poignant reminder of how impossible separate compilation is in the EDA world.
A proper analogy would involve separately compiling the Verilog into some kind of low-level representation, and then linking would properly smash together those separately-compiled objects.
Instead, in Xilinx-land, “compilation” is just simple bundling and “linking” does all the compilation in one monolithic step.
It’s kind of cute that the Xilinx toolchain is pretending the world is otherwise, but it’s also kind of sad.</p>
<p>Anyway, the only way to produce a <code>.xo</code> file from RTL code appears to be to use Vivado (i.e., the actual <code>vivado</code> program).
Nothing from the newer Vitis package currently appears capable of producing <code>.xo</code> files from Verilog (although <code>v++</code> can produce these files during HLS compilation, presumably by invoking Vivado).</p>
<p>The main components in an <code>.xo</code> file, aside from the Verilog source code itself, are two XML files:
<code>kernel.xml</code>, a short file describing the argument interfaces to the hardware design,
and <code>component.xml</code>, a much longer and more complicated <a href="https://en.wikipedia.org/wiki/IP-XACT">IP-XACT</a> file that also has to do with the interface to the RTL.
We currently generate <code>kernel.xml</code> ourselves (with the <code>xilinx-xml</code> backend described above) and then use Vivado, via a Tcl script, to generate the IP-XACT file.</p>
<p>In the future, we could consider trying to route around using Vivado by generating the IP-XACT file ourselves, using a tool such as <a href="https://github.com/sifive/duh">DUH</a>.</p>
<h4 id="our-completion-workflow"><a class="header" href="#our-completion-workflow">Our Completion Workflow</a></h4>
<p>The first step is to produce an <code>.xo</code> file.
We also use <a href="https://github.com/calyxir/calyx/blob/master/fud/bitstream/gen_xo.tcl">a static Tcl script, <code>gen_xo.tcl</code>,</a> which is a simplified version of <a href="https://github.com/Xilinx/Vitis-Tutorials/blob/2021.1/Hardware_Acceleration/Feature_Tutorials/01-rtl_kernel_workflow/reference-files/scripts/package_kernel.tcl">a script from Xilinx's Vitis tutorials</a>.
The gist of this script is that it creates a Vivado project, adds the source files, twiddles some settings, and then uses the <a href="https://docs.amd.com/r/en-US/ug1702-vitis-accelerated-reference/package_xo-Command"><code>package_xo</code> command</a> to read stuff from this project as an "IP directory" and produce an <code>.xo</code> file.
The Vivado command line looks roughly like this:</p>
<pre><code>vivado -mode batch -source gen_xo.tcl -tclargs xclbin/kernel.xo
</code></pre>
<p>That output filename after <code>-tclargs</code>, unsurprisingly, gets passed to <a href="https://github.com/calyxir/calyx/blob/master/fud/bitstream/gen_xo.tcl"><code>gen_xo.tcl</code></a>.</p>
<p>Then, we take this <code>.xo</code> and turn it into an <a href="https://xilinx.github.io/XRT/2021.2/html/formats.html#xclbin"><code>.xclbin</code></a>.
This step uses the <code>v++</code> tool, with a command line that looks like this:</p>
<pre><code>v++ -g -t hw_emu --platform xilinx_u50_gen3x16_xdma_201920_3 --save-temps --profile.data all:all:all --profile.exec all:all:all -lo xclbin/kernel.xclbin xclbin/kernel.xo
</code></pre>
<p>Fortunately, the <code>v++</code> tool doesn't need any Tcl to drive it; all the action happens on the command line.</p>
<h4 id="execution-via-xclrun"><a class="header" href="#execution-via-xclrun">Execution via <code>xclrun</code></a></h4>
<p>Now that we have an <code>.xclbin</code> file, we need a way to execute it (either in simulation or on a real FPGA).
We have a tool called <code>xclrun</code> that just executes a given <code>.xclbin</code> bitstream, supplying it with data in a fud-style JSON format and formatting the results in the same way.
In fact, it's possible to use it directly---it's invokable with <code>python -m fud.xclrun</code>.
However, it's somewhat annoying to use directly because you have to carefully set up your environment first---this setup stage appears to be unavoidable when using the Xilinx runtime libraries.
So an invocation of <code>xclrun</code> actually looks something like this:</p>
<pre><code>EMCONFIG_PATH=`pwd` XCL_EMULATION_MODE=hw_emu XRT_INI_PATH=`pwd`/xrt.ini \
    bash -c 'source /scratch/opt/Xilinx/Vitis/2020.2/settings64.sh ; source /scratch/opt/xilinx/xrt/setup.sh ; python3.9 -m fud.xclrun foo.xclbin examples/tutorial/data.json'
</code></pre>
<p>This monster of a command first sets three environment variables that XRT and the simulation process will need, and then it <code>source</code>s the relevant setup scripts before finally launching <code>xclrun</code>.
The two actual arguments to the tool are just the <code>.xclbin</code> executable itself and the JSON input data; the tool prints the output data to stdout by default.</p>
<p>fud's <code>execute</code> stage is just a big wrapper around launching <code>xclrun</code>.
It sets up the necessary input files and constructs a command line that looks much like the above example.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../running-calyx/fud/examples.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../running-calyx/fud/axi-gen.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../running-calyx/fud/examples.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../running-calyx/fud/axi-gen.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
