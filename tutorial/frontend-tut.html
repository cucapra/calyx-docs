<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Frontend Tutorial - Calyx Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../css/general-2459343d.css">
        <link rel="stylesheet" href="../css/chrome-ae938929.css">
        <link rel="stylesheet" href="../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex-7bb61c73.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc-ed8c4c3b.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">Calyx Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="building-a-frontend-for-calyx"><a class="header" href="#building-a-frontend-for-calyx">Building a Frontend for Calyx</a></h1>
<blockquote>
<p>This tutorial assumes that you have already worked through the <a href="./language-tut.html">Calyx tutorial</a>. You won’t get very much out of it by itself!</p>
</blockquote>
<p>In the <a href="./language-tut.html">Calyx tutorial</a> you wrote Calyx code by hand.
This is (probably) a good way to build character, but it’s no way to live.
Indeed, Calyx was <em>designed</em> to be a compiler IL, and not a human-facing language.</p>
<p>In this tutorial, we’re going to learn all about this by building a DSL-to-hardware compiler for a toy language that we wish to accelerate.
We will compile the DSL to Calyx, and then let Calyx take us to hardware.</p>
<h1 id="mrxl-overview"><a class="header" href="#mrxl-overview">MrXL Overview</a></h1>
<p>Meet MrXL, our toy DSL.
MrXL lets you define arrays and registers and then perform <code>map</code> and <code>reduce</code> operations.</p>
<h2 id="example-sum-of-squares"><a class="header" href="#example-sum-of-squares">Example: sum of squares</a></h2>
<p>Here’s a MrXL program that squares and then sums the values of an input array:</p>
<pre><code>input avec: int[4]
output sos: int
squares := map 1 (a &lt;- avec) { a * a }
sos := reduce 1 (acc, i &lt;- squares) 0 { acc + i }
</code></pre>
<p>This short program shows off all of MrXL’s features, so let’s pick it apart line by line:</p>
<ol>
<li>We specify an array, <code>avec</code>, which will have four integers. The <code>input</code> keyword means that an external harness will populate the array.</li>
<li>We specify <code>sos</code>, a register. The <code>output</code> keyword means that we will populate <code>sos</code> in our program.</li>
<li>The <code>map</code> operation gets the values of <code>avec</code> and raises each to the second power. We stash the result in a new array, <code>squares</code>. The number <code>1</code> denotes a <em>parallelism factor</em> of 1, meaning that the operation is performed sequentially. We will improve this shortly.</li>
<li>The <code>reduce</code> operation walks over <code>squares</code> and accumulates the result into a register. The parallelism factor is again <code>1</code>.</li>
</ol>
<h2 id="running-our-example"><a class="header" href="#running-our-example">Running our example</a></h2>
<h3 id="installing-mrxl"><a class="header" href="#installing-mrxl">Installing MrXL</a></h3>
<blockquote>
<p>If you are going through this tutorial in the <a href="https://github.com/calyxir/calyx/pkgs/container/calyx">Docker container</a>, you can skip these installation steps and jump to <a href="#running-mrxl"><em>Running MrXL</em></a> just below.</p>
</blockquote>
<p>First, install the <a href="../calyx-py.html"><code>builder</code> library</a> by typing the following command from the repository root:</p>
<pre><code>cd calyx-py &amp;&amp; flit install -s &amp;&amp; cd -
</code></pre>
<p>Next, install the <code>mrxl</code> binary:</p>
<pre><code>cd frontends/mrxl &amp;&amp; flit install -s &amp;&amp; cd -
</code></pre>
<h3 id="running-mrxl"><a class="header" href="#running-mrxl">Running MrXL</a></h3>
<p>Run:</p>
<pre><code>mrxl frontends/mrxl/test/sos.mrxl --data frontends/mrxl/test/sos.mrxl.data --interpret
</code></pre>
<p>Why <code>42</code>? Because we populated <code>avec</code> with:</p>
<pre><code class="language-json">{
  "avec": [
    0,
    1,
    4,
    5
  ]
}
</code></pre>
<p>and \( 0^2 + 1^2 + 4^2 + 5^2 = 42 \).</p>
<h2 id="compiling-our-example-into-calyx"><a class="header" href="#compiling-our-example-into-calyx">Compiling our example into Calyx</a></h2>
<p>Above, we merely <em>interpreted</em> MrXL code in software using a simple, pre-written interpreter implemented in Python.
Our goal in this tutorial is to build a compiler from MrXL to hardware by translating it to the Calyx IL.
The Calyx IL code generated by compiling this program looks more like:</p>
<details>
<summary>Click to expand 103 lines.</summary>
<pre><code class="language-C">import "primitives/core.futil";
import "primitives/binary_operators.futil";
component main() -&gt; () {
  cells {
    @external avec_b0 = comb_mem_d1(32, 4, 32);
    @external sos = comb_mem_d1(32, 1, 32);
    sos_reg = std_reg(32);
    squares_b0 = comb_mem_d1(32, 4, 32);
    idx_b0_0 = std_reg(32);
    incr_b0_0 = std_add(32);
    lt_b0_0 = std_lt(32);
    mul_b0_0 = std_mult_pipe(32);
    idx1 = std_reg(32);
    incr_1 = std_add(32);
    lt_1 = std_lt(32);
    add_1 = std_add(32);
  }
  wires {
    group sos_reg2mem {
      sos.addr0 = 32'd0;
      sos.write_data = sos_reg.out;
      sos.write_en = 1'd1;
      sos_reg2mem[done] = sos.done;
    }
    group incr_idx_b0_0 {
      incr_b0_0.left = idx_b0_0.out;
      incr_b0_0.right = 32'd1;
      idx_b0_0.in = incr_b0_0.out;
      idx_b0_0.write_en = 1'd1;
      incr_idx_b0_0[done] = idx_b0_0.done;
    }
    comb group cond_b0_0 {
      lt_b0_0.left = idx_b0_0.out;
      lt_b0_0.right = 32'd4;
    }
    group eval_body_b0_0 {
      avec_b0.addr0 = idx_b0_0.out;
      mul_b0_0.left = avec_b0.read_data;
      mul_b0_0.right = avec_b0.read_data;
      squares_b0.addr0 = idx_b0_0.out;
      squares_b0.write_data = mul_b0_0.out;
      mul_b0_0.go = 1'd1;
      squares_b0.write_en = mul_b0_0.done;
      eval_body_b0_0[done] = squares_b0.done;
    }
    group init_idx_1 {
      idx1.in = 32'd0;
      idx1.write_en = 1'd1;
      init_idx_1[done] = idx1.done;
    }
    group incr_idx_1 {
      incr_1.left = idx1.out;
      incr_1.right = 32'd1;
      idx1.in = incr_1.out;
      idx1.write_en = 1'd1;
      incr_idx_1[done] = idx1.done;
    }
    comb group cond_1 {
      lt_1.left = idx1.out;
      lt_1.right = 32'd4;
    }
    group init_1 {
      sos_reg.in = 32'd0;
      sos_reg.write_en = 1'd1;
      init_1[done] = sos_reg.done;
    }
    group reduce1 {
      squares_b0.addr0 = idx1.out;
      add_1.left = sos_reg.out;
      add_1.right = squares_b0.read_data;
      sos_reg.in = add_1.out;
      sos_reg.write_en = 1'd1;
      reduce1[done] = sos_reg.done;
    }
  }
  control {
    seq {
      par {
        while lt_b0_0.out with cond_b0_0 {
          seq {
            eval_body_b0_0;
            incr_idx_b0_0;
          }
        }
      }
      seq {
        par {
          init_1;
          init_idx_1;
        }
        while lt_1.out with cond_1 {
          seq {
            reduce1;
            incr_idx_1;
          }
        }
      }
      par {
        sos_reg2mem;
      }
    }
  }
}
</code></pre>
</details>
<p>Generate it for yourself! Run:</p>
<pre><code>mrxl frontends/mrxl/test/sos.mrxl
</code></pre>
<h2 id="simulating-our-example-with-verilog"><a class="header" href="#simulating-our-example-with-verilog">Simulating our example with Verilog</a></h2>
<p>Finally, let us go the whole hog: we compile our MrXL program to Calyx, compile it to Verilog, then simulate it using <a href="https://www.veripool.org/wiki/verilator">Verilator</a>.</p>
<p>Run:</p>
<pre><code>mrxl --convert --data frontends/mrxl/test/sos.mrxl.data frontends/mrxl/test/sos.mrxl &gt; sos.data
fud2 --from mrxl frontends/mrxl/test/sos.mrxl --to dat --through verilator -s sim.data=sos.data
</code></pre>
<p>The above commands take a MrXL program, <code>sos.mrxl</code>, and generates results with Verilator using the MrXL data file <code>sos.mrxl.data</code>.</p>
<h1 id="compiling-mrxl-into-calyx"><a class="header" href="#compiling-mrxl-into-calyx">Compiling MrXL into Calyx</a></h1>
<p>Calyx is an infrastructure for designing <em>domain-specific languages</em> (DSL) which can generate efficient hardware.
The rest of the tutorial will show you how to implement such a DSL by studying <a href="https://github.com/calyxir/calyx/blob/master/frontends/mrxl/mrxl/gen_calyx.py">the MrXL-to-Calyx compiler</a>, written in Python.</p>
<p>We have placed a few simplifying restrictions on MrXL programs:</p>
<ol>
<li>Every array in a MrXL program has the same length.</li>
<li>Every integer in our generated hardware is 32 bits long.</li>
<li>The bodies of <code>map</code> and <code>reduce</code> operations must be binary <code>+</code> or <code>*</code> operations involving array elements or integers.</li>
<li>If repeated <code>map</code>/<code>reduce</code> operations are performed on the same array, each of those operations must have the same parallelism factor.</li>
<li>All <code>reduce</code> operations must be performed sequentially, i.e., with parallelism factor <code>1</code>.</li>
</ol>
<p>These restrictions can be lifted or relaxed via commensurate changes to the compiler.</p>
<p>The compilation process breaks into two steps:</p>
<ol>
<li>Parsing MrXL into a representation we can process in Python.</li>
<li>Generating Calyx code.</li>
</ol>
<h2 id="parsing-mrxl-into-an-ast"><a class="header" href="#parsing-mrxl-into-an-ast">Parsing MrXL into an AST</a></h2>
<p>To start, we’ll parse the MrXL program into a Python AST representation.
We choose to represent <a href="https://github.com/calyxir/calyx/blob/master/frontends/mrxl/mrxl/ast.py">AST</a> nodes with <a href="https://docs.python.org/3/library/dataclasses.html">Python dataclasses</a>.
A program is a sequence of array/register declarations followed by computation statements:</p>
<pre><code class="language-python">@dataclass
class Prog:
    """A MrXL program."""
    decls: List[Decl]  # Memory declarations
    stmts: List[Stmt]  # Map and reduce statements
</code></pre>
<p><code>Decl</code> nodes correspond to array declarations such as <code>input avec: int[4]</code>.
They carry information about whether the array is an <code>input</code> or <code>output</code>, the array’s name, and the type of the array’s elements:</p>
<pre><code class="language-python">@dataclass
class Decl:
    """Declaration of a memory."""
    input: bool  # If `False`, this is an `output`.
    name: str
    type: Type
</code></pre>
<p><code>Stmt</code> nodes represent statements such as <code>sos := reduce 1 (acc, i &lt;- squares) 0 { acc + i }</code>.
They contain further nested nodes representing the function-header and -body, and the type of operation:</p>
<pre><code class="language-python">@dataclass
class Stmt:
    """A statement in the program."""
    dst: str
    operation: Union[Map, Reduce]
</code></pre>
<p>We elide further details, but point you to the <a href="https://github.com/calyxir/calyx/blob/master/frontends/mrxl/mrxl/ast.py">AST</a>, which defines all the nodes we need to represent a MrXL program.</p>
<h2 id="generating-calyx-code"><a class="header" href="#generating-calyx-code">Generating Calyx code</a></h2>
<p><a href="./language-tut.html">As you know</a>, the skeleton of a Calyx program has three sections:</p>
<pre><code>component main() -&gt; {
  cells {}
  wires {}
  control {}
}
</code></pre>
<p>The <a href="../lang/ref.html#cells">cells section</a> instantiates hardware units like adders, memories and registers.
The <a href="../lang/ref.html#the-wires-section">wires section</a> contains <a href="../lang/ref.html#group-definitions">groups</a> that connect
hardware instances to perform some logical task (e.g, incrementing a register).
Finally, the <a href="../lang/ref.html#the-control-operators">control section</a> <em>schedules</em> the execution of groups using control operators such as <code>seq</code>, <code>par</code>, and <code>while</code>.</p>
<p>We perform syntax-directed compilation by walking over the nodes of the AST and generating <code>cells</code>, <code>wires</code>, and <code>control</code> operations.</p>
<h3 id="an-embedded-dsl-that-generates-calyx"><a class="header" href="#an-embedded-dsl-that-generates-calyx">An Embedded DSL that Generates Calyx</a></h3>
<p>To make it easy to generate hardware, we’ll use Calyx’s <a href="../calyx-py.html"><code>builder</code> module</a> written in Python:</p>
<pre><code class="language-python">import calyx.builder as cb

prog = cb.Builder() # A Calyx program
main = prog.component("main") # Create a component named "main"
</code></pre>
<h3 id="decl-nodes"><a class="header" href="#decl-nodes"><code>Decl</code> nodes</a></h3>
<p><code>Decl</code> nodes instantiate new memories and registers.
We need these to be instantiated in the <code>cells</code> section of our Calyx output.
We use Calyx’s <a href="https://github.com/calyxir/calyx/blob/45075345ae2858b23a599d65d94b0ed7bf949a61/primitives/compile.futil#L22"><code>std_reg</code></a> and <a href="https://github.com/calyxir/calyx/blob/45075345ae2858b23a599d65d94b0ed7bf949a61/primitives/compile.futil#L22"><code>comb_mem_d1</code></a> primitives to represent <a href="https://github.com/calyxir/calyx/blob/master/primitives/compile.futil#L31">registers</a> and <a href="https://github.com/calyxir/calyx/blob/master/primitives/core.sv#L220">memories</a>:</p>
<pre><code class="language-C">import "primitives/core.futil"; // Import standard library

component main() -&gt; () {
  cells {
    // A memory with 4 32-bit elements. Indexed using a 6-bit value.
    avec = comb_mem_d1(32, 4, 6);
    // A register that contains a 32-bit value
    sos = std_reg(32);
  }
  ...
}
</code></pre>
<p>For each <code>Decl</code> node, we need to determine if we’re instantiating a memory or a register, translate the node into a corresponding Calyx declaration, and place the declaration inside the <code>cells</code> section of our generated program.</p>
<p>If a memory is used in a parallel <code>map</code> or <code>reduce</code>, we might need to create different physical banks for it.
We explain why <a href="#memory-banking">below</a>.
We <a href="https://github.com/calyxir/calyx/blob/45075345ae2858b23a599d65d94b0ed7bf949a61/frontends/mrxl/mrxl/gen_calyx.py#L312">define a function</a> to walk over the AST and compute the parallelism factor for each memory:</p>
<pre><code class="language-python">    # Collect banking factors.
    par_factor = compute_par_factors(prog.stmts)
</code></pre>
<p>Using this information, we can instantiate registers and memories for our inputs and outputs:</p>
<pre><code class="language-python">            for i in range(par):
                main.comb_mem_d1(
                    f"{name}_b{i}", 32, arr_size // par, 32, is_external=True
                )
</code></pre>
<p>The <code>main.mem_d1</code> call is a function defined by the Calyx builder module to instantiate memories for a component.
By setting <code>is_external=True</code>, we’re indicating that a memory declaration is a part of the component’s input-output interface.</p>
<h2 id="compiling-map-operations"><a class="header" href="#compiling-map-operations">Compiling <code>map</code> operations</a></h2>
<p>For every <code>map</code> or <code>reduce</code> node, we need to generate Calyx code that iterates over an array, performs some kind of computation, and then stores the result of that computation.
For <code>map</code> operations, we’ll perform a computation on every element of an input array, and then store the answers in a result array.
We can use Calyx’s <a href="../lang/ref.html#while">while loops</a> to do this.
At a high level, we want to generate the following pieces of hardware:</p>
<ol>
<li>A register to store the current value of the loop index.</li>
<li>A comparator to check of the loop index is less than the array size.</li>
<li>An adder to increment the value of the index.</li>
<li>Whatever hardware is needed to implement the loop body computation.</li>
</ol>
<p>We have implemented exactly this, and you have been using it thus far with the <code>fud2</code> invocations that we have provided you.</p>
<p>However, it is time to get your hands dirty.
We provide a <a href="https://github.com/calyxir/calyx/blob/master/frontends/mrxl/mrxl/gen_calyx.py#L171-L191">stub implementation</a> of <code>map</code> in <code>gen_calyx.py</code>:</p>
<pre><code class="language-python">def my_map_impl(
    comp: cb.ComponentBuilder,
    dest: str,
    stmt: ast.Map,
    arr_size: int,
    bank_factor: int,
    s_idx: int,
):
    """
    Returns a dictionary containing Calyx cells, wires and
    control needed to implement a `map` statement.
    See gen_stmt_impl for format of the dictionary.

    Generates these groups:
      - a group that implements the body of the `map` statement
      - a group that increments an index to access the `map` input array
      - a group that implements the loop condition, checking if the index
        has reached the end of the input array
    """
    # TODO: Implement map!
    return Empty()
</code></pre>
<p>You are invited to try implementing map yourself according to the outline given in the description by filling in the body of this function.</p>
<p>To run <code>mrxl</code> with <code>my_map_impl</code> instead of our implementation, pass the <code>--my-map</code> flag:</p>
<pre><code class="language-sh">fud2 --from mrxl test/sos.mrxl \
     --to dat --through verilator \
     -s mrxl.flags="--my-map "  \
     -s sim.data=sos.data
</code></pre>
<p>If you are feeling good about your implementation, skip to <a href="#adding-parallelization">the next section</a>!
If you’d like to read through the details of our implementation – or build yours in tandem – continue on with the rest of this section.</p>
<h3 id="loop-condition"><a class="header" href="#loop-condition">Loop condition</a></h3>
<p>We define a <a href="../lang/ref.html#comb-group-definitions">combinational group</a> to perform the comparison <code>idx &lt; arr_size</code> that uses an <code>lt</code> cell:</p>
<pre><code class="language-python">    group_name = f"cond_{suffix}"
    cell = f"lt_{suffix}"
    less_than = comp.cell(cell, Stdlib.op("lt", 32, signed=False))
    with comp.comb_group(group_name):
        less_than.left = idx.out
        less_than.right = arr_size
</code></pre>
<h3 id="index-increment"><a class="header" href="#index-increment">Index increment</a></h3>
<p>The loop index increment is implemented using a <a href="../lang/ref.html#group-definitions">group</a> and an <code>adder</code>:</p>
<pre><code class="language-python">    group_name = f"incr_idx_{suffix}"
    adder = comp.add(32)
    with comp.group(group_name) as incr:
        adder.left = idx.out
        adder.right = 1
        idx.in_ = adder.out
        idx.write_en = 1
        incr.done = idx.done
</code></pre>
<p>We provide the index’s previous value and the constant <code>1</code> to <code>adder</code>, and write the adder’s output into the register (<code>idx</code>).
Because we’re performing a stateful update of the register, we must wait for the register to state that it has committed the write.
We do this by setting the group’s <code>done</code> condition to track the register’s <code>done</code> signal.</p>
<h3 id="body-computation"><a class="header" href="#body-computation">Body computation</a></h3>
<p>The final piece of the puzzle is the body’s computation.
The corresponding group indexes into the input memories:</p>
<pre><code class="language-python">        with comp.group(f"eval_body_{suffix}") as evl:
            # Index each array
            for bind in stmt.binds:
                # Map bindings have exactly one dest
                mem = comp.get_cell(f"{name2arr[bind.dst[0]]}")
                mem.addr0 = idx.out
</code></pre>
<p>Because the builder module is an embedded DSL, we can simply use Python’s <code>for</code> loop to generate all the required assignments for indexing.</p>
<p>This code instantiates an adder or a multiplier depending on the computation needed using the <code>expr_to_port</code> helper function:</p>
<pre><code class="language-python">        if body.operation == "mul":
            operation = comp.cell(
                f"mul_{suffix}", Stdlib.op("mult_pipe", 32, signed=False)
            )
        else:
            operation = comp.add(32, f"add_{suffix}")
</code></pre>
<p>and writes the value from the operation into the output memory:</p>
<pre><code class="language-py">            out_mem = comp.get_cell(f"{dest}_b{bank}")
            out_mem.addr0 = idx.out
            out_mem.write_data = operation.out
            # Multipliers are sequential so we need to manipulate go/done signals
            if body.operation == "mul":
                operation.go = 1
                out_mem.write_en = operation.done
            else:
                out_mem.write_en = 1
            evl.done = out_mem.done
</code></pre>
<p>This final operation is complicated because we must account for whether we’re using an adder or a multiplier.
Adders are <em>combinational</em>–they produce their output immediately–while multipliers are <em>sequential</em> and require multiple cycles to produce its output.</p>
<p>When using a mutliplier, we need to explicitly set its <code>go</code> signal to one and only write the output from the multiplier into the memory when its <code>done</code> signal is asserted.
We do this by assigning the memory’s <code>write_en</code> (write enable) signal to the multiplier’s done signal.
Finally, the group’s computation is done when the memory write is committed.</p>
<h3 id="generating-control"><a class="header" href="#generating-control">Generating control</a></h3>
<p>Once we have generated the hardware needed for our computation, we can schedule its computation using <a href="../lang/ref.html#the-control-operators">control operators</a>:</p>
<pre><code class="language-py">            While(
                CompPort(CompVar(port), "out"),
                CompVar(cond),
                SeqComp(
                    [
                        Enable(f"eval_body_{suffix}"),
                        Enable(incr),
                    ]
                ),
            )
</code></pre>
<p>We generate a while loop that checks that the index is less than the array size.
Then, it sequentially executes the computation for the body and increments the loop index.</p>
<blockquote>
<p>Take a breather! You now understand the basics of compiling DSLs to Calyx.
However, we’re not done yet; we build hardware because we want things to be fast and efficient, so the next part will teach you how to parallelize MrXL programs.</p>
</blockquote>
<h2 id="adding-parallelization"><a class="header" href="#adding-parallelization">Adding parallelization</a></h2>
<p>MrXL allows us to parallelize our <code>map</code> operations.</p>
<p>Consider a variation on our prior example:</p>
<pre><code>input avec: int[4]
output squares: int[4]
squares := map 2 (a &lt;- avec) { a * a }
</code></pre>
<p>The noteworthy change is the parallelism factor of the <code>map</code> operation.
The parallelism factor <code>2</code> specifies that two copies of the loop bodies should be executed in parallel.</p>
<p>Translating this into a hardware implementation has a couple of associated challenges:</p>
<ol>
<li>Our memories (<code>comb_mem_d1</code>) are <em>extremely</em> primitive and do not support parallel accesses; a program may only read or write to one memory location every cycle. In order to support parallel accesses, we need to create <em>multiple physical banks</em> that represent one logical memory and contain distinct elements.</li>
<li>We need to generate <em>multiple copies</em> of the hardware we generated above because, again, adders and multipliers are physical resources and can only support one computation at a time.</li>
</ol>
<p>To produce the full Calyx program for the above example, run the following from the root of the Calyx repository:</p>
<pre><code>fud2 --from mrxl --to calyx frontends/mrxl/test/squares.mrxl
</code></pre>
<h3 id="memory-banking"><a class="header" href="#memory-banking">Memory banking</a></h3>
<!-- Let us look back at our example featuring a parallel `map`:
```
input avec: int[4]
output squares: int[4]
squares := map 2 (a <- avec) { a * a }
```

Interpret this with:
```
mrxl frontends/mrxl/test/squares.mrxl --data frontends/mrxl/test/squares.mrxl.data --interpret
```

But more interestingly, compile this to Calyx IL with:
```
mrxl frontends/mrxl/test/squares.mrxl
``` -->
<p>There’s a lot going on in the Calyx code, but the thing to focus on is this.
To take advantage of the parallelism in the program, the MrXL compiler assumes that the input memory <code>avec</code> is split into two <em>banks</em>, <code>avec_b0</code> and <code>avec_b1</code>.
Look for these in the Calyx code.</p>
<p>Why do we do this? Memories in Calyx can only support one read/write per cycle of the clock, so if we keep <code>avec</code> around as one memory, our attempts at parallelization will be thwarted simply because we will be bottlenecked when accessing our data.
Splitting <code>avec</code> into two banks allows us to read/write into two logical spots of <code>avec</code> in parallel.</p>
<p>Banking comes with an additional responsibility.
When driving data to the memories, we can’t just supply values for a memory <code>avec</code>.
The memory <code>avec</code> exists logically in our minds, but Calyx now only knows about <code>avec_b0</code> and <code>avec_b1</code>.
We must drive data to <em>these</em>.
Though nontrivial, this data-banking can also be <a href="#aside-supplying-data-to-mrxl-programs">handled automatically</a>; all the necessary information is in the MrXL source program.</p>
<h3 id="parallel-control"><a class="header" href="#parallel-control">Parallel Control</a></h3>
<p>Next, our compiler duplicates the computational resources, hooks them up to the right memories using groups, and generates a control program that looks like this:</p>
<pre><code>par {
  while le_b0.out with cond_b0 { seq { eval_body_b0; incr_idx_b0; } }
  while le_b1.out with cond_b1 { seq { eval_body_b1; incr_idx_b1; } }
}
</code></pre>
<p>The <a href="../lang/ref.html#par"><code>par</code> operator</a> executes all the loops in parallel which use distinct computational resources.
As specified by the language specification, <a href="../lang/ref.html#par">conflicting resource usage is undefined behavior</a>.</p>
<p>You can use <code>fud2</code> to compile the MrXL program and run it with some data:</p>
<pre><code>fud2 --from mrxl --to dat \
     --through verilator \
     -s sim.data=squares.data \
     frontends/mrxl/test/squares.mrxl
</code></pre>
<blockquote>
<p>The <a href="https://github.com/calyxir/calyx/blob/master/frontends/mrxl/mrxl/gen_calyx.py">complete implementation</a> shows the necessary code to create physical memory banks and create an outer loop to generate distinct hardware for each copy of the loop.</p>
</blockquote>
<h1 id="further-steps"><a class="header" href="#further-steps">Further Steps</a></h1>
<p>Congratulations, you know about as much about MrXL as we do!
The small size of the language makes it a nice sandbox for you to play in.
We mentioned that the restrictions placed on the language can be lifted by beefing up the compiler, and here’s your chance to give it a whirl!</p>
<p>Here are some of those restrictions again, along with pointers about how to lift them.</p>
<ol>
<li>
<blockquote>
<p>The bodies of <code>map</code> and <code>reduce</code> operations must be binary <code>+</code> or <code>*</code> operations involving array elements or integers.</p>
</blockquote>
<p>Say you wanted to add subtraction and division to the mix.
We have set you up for success: the MrXL parser already parses <code>-</code> and <code>/</code> into <code>sub</code> and <code>div</code> respectively.
Now, in <code>gen_calyx.py</code>, you need to check for “sub” and “div” as possible binary operations, and then invoke the appropriate cell-builders of the <code>builder</code> library.
For reference, see how the <code>+</code> and <code>*</code> operations are handled at present.
For “fun”, take a look at how Calyx implements <a href="https://github.com/calyxir/calyx/blob/master/primitives/binary_operators.sv#L27-L45">multiplication</a>, and how that maps to the existing invocation to create a 32-bit multiplication cell using the <code>builder</code>!</p>
</li>
<li>
<blockquote>
<p>All <code>reduce</code> operations must be performed sequentially, i.e., with parallelism factor <code>1</code>.</p>
</blockquote>
<p>This is a big gap!
One way to perform reductions in parallel is using <em>reduction trees</em>.
To get you started, we provide a toy implementation using the <code>builder</code> <a href="https://github.com/calyxir/calyx/blob/master/calyx-py/test/reduction_tree.py">here</a>.
That example is rather brittle: it takes exactly 16 inputs, banked into four arrays, and adds their values together.
Try incorporating this brittle version into your MrXL-to-Calyx compiler at first, and you can later think about generalizing it to any (commutative) operation, memories of any length, and any parallelism factor.</p>
<p>If you’d like to read more about reduction trees, you can check out <a href="http://www.cs.ucr.edu/~nael/217-f15/lectures/217-lec10.pdf">these slides</a> from David Kirk and Wen-mei W. Hwu.</p>
</li>
<li>
<blockquote>
<p>If repeated <code>map</code>/<code>reduce</code> operations are performed on the same array, each of those operations must have the same parallelism factor.</p>
</blockquote>
<p>The heart of the issue is figuring out how to bank the underlying array.
How do we bank it two different ways at the same time?
The answer is to bank the array a little finer than you think, and to then use <em>arbitration logic</em> to provide two fictional banking setups at the same time.
We provide a toy implementation using the <code>builder</code> <a href="https://github.com/calyxir/calyx/blob/master/calyx-py/test/arbiter_6.py">here</a>.
There, a 24-cell array has been split into <em>six</em> banks, but then we allow the user to pretend, simultaneously, that it is split into <em>two</em> banks or <em>three</em> banks.</p>
</li>
</ol>
<h1 id="aside-supplying-data-to-mrxl-programs"><a class="header" href="#aside-supplying-data-to-mrxl-programs">Aside: supplying data to MrXL programs</a></h1>
<p>You may have noticed that the data files that we pass to MrXL programs are lighter-weight than those we pass to Calyx programs.
They are lighter in two ways.</p>
<h2 id="boilerplate"><a class="header" href="#boilerplate">Boilerplate</a></h2>
<p>Calyx requires cells to be allocated for the output cells.
Instead of asking the user to supply zeroed-out arrays and registers for output cells, we can infer the need for these output cells from the source code.
We can then add these on to the MrXL-native data files to make them amenable to Calyx.</p>
<p>Additionally, because MrXL supports only a few kinds of data, some interesting parameters of Calyx-native data files turn into “just boilerplate” in MrXL-native data.
We can keep MrXL-native data files relatively light and add this <code>format</code> information automatically.</p>
<h2 id="example-squaresmrxldata"><a class="header" href="#example-squaresmrxldata">Example: <code>squares.mrxl.data</code></a></h2>
<p>Let us look at these changes in practice.</p>
<p>We write <code>avec</code>’s values as a straightforward array:</p>
<pre><code class="language-json">{
	"avec": [
			0,
			1,
			4,
			5
		]
}
</code></pre>
<p>but under the hood, the <em>Calyx IL version</em> of <code>squares.mrxl</code> comes to expect something of the form:</p>
<pre><code class="language-json">{
    "avec_b0": {
        "data": [
            0,
            1
        ],
        "format": {
            "is_signed": false,
            "numeric_type": "bitnum",
            "width": 32
        }
    },
    "avec_b1": {
        "data": [
            4,
            5
        ],
        "format": {
            "is_signed": false,
            "numeric_type": "bitnum",
            "width": 32
        }
    },
    "squares_b0": {
        "data": [
            0,
            0
        ],
        "format": {
            "is_signed": false,
            "numeric_type": "bitnum",
            "width": 32
        }
    },
    "squares_b1": {
        "data": [
            0,
            0
        ],
        "format": {
            "is_signed": false,
            "numeric_type": "bitnum",
            "width": 32
        }
    }
}
</code></pre>
<p>And we can generate this automatically. Try it yourself:</p>
<pre><code>mrxl frontends/mrxl/test/squares.mrxl --data frontends/mrxl/test/squares.mrxl.data --convert
</code></pre>
<p>This transformation is achieved using a <a href="../running-calyx/fud2"><code>fud2</code></a> pass that converts MrXL-native data files into Calyx-native data files.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../builder/walkthrough.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../frontends/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../builder/walkthrough.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../frontends/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../mark-09e88c2c.min.js"></script>
        <script src="../searcher-c2a407aa.js"></script>

        <script src="../clipboard-1626706a.min.js"></script>
        <script src="../highlight-abc7f01d.js"></script>
        <script src="../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
